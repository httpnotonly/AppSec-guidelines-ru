# Безопасная загрузка файлов на сервер

## Рекомендации

 1. На Back-end сервере используйте случайно созданное имя для хранения файла, вместо присланного пользователем.
 2. Используйте белый список символов для имени файла
 3. Если это невозможно, то очистите имя файла от спецсимволов. В частности от [RLO](https://xakep.ru/2018/02/13/telegram-rlo/).
 4. Используйте только белые списки для проверки расширений файлов.
 5. Для создания белого списка используйте следующую табличку:

|Mime types|Extensions|[Magic Bytes](https://www.filesignatures.net/index.php?page=all)|
|--|--|--|
|image/jpeg|.jpeg /.jpg| FF D8 FF E0 |
|--|--|--|

6. Все проверки на стороне клиента должны дублироваться на стороне сервера.
7. Храните файлы за пределами корневой папки веб приложения.
8. Отберите у файловой системы возможность запуска файлов.

## Валидация расширения:

- [ ] Расширение входит в список разрешенных расширений независимо от регистра.
- [ ] Mime-type входит в список разрешенных (если к вам в приложение должен прилетать mime-type = octet-stream, то  переходите к следующим проверкам)
- [ ] Бинарный заголовок файла входит в список разрешенных форматов файла.
- [ ] Расширение, mime-type и бинарный заголовок принадлежат одному типу файлов.
- [ ] Размер файла не превышает допустимый размер.
